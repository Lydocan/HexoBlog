---
title: 浏览器输入URL后都发生了什么
date: 2018-11-25 10:14:06
tags:
---

# 关于浏览器输入URL后发生的事儿

> 序：
>  
> 其实这个话题已经有各位大牛解释过，这篇blog一来想整理网上的各种观点和分析，二来也是希望借此学习，扩宽知识面。其实很多内容都不甚深入了解，也可能不曾接触，所以会一笔带过。有些内容可能会重复，第二次谈起就省略个中细节，以免赘述。
>  
> 为了把事情阐述清楚，本文采用分模块的方式来写。另外，本文参考多篇他人写的博客，博文底部会给出相关链接。行文过程中，一些猜测或者不确定的地方，会有类似“似乎”、“可能”等字眼。基于写作者的知识匮乏，行文必然会有谬误，如果有了解这方面知识的人，请帮忙指正，感激不尽。
>  
> 本文希望能有抛砖引玉之效果，引起同行的兴趣和思考。

## 输入URL以及之后发生的事

平常我们浏览网页的时候，大概是这么一个场景：“打开浏览器，在网址上输入www.baidu.com，然后按下回车，就能看到百度首页了”。就这么一个稀松平常的事儿，底下涉及的事情，可不简单。

首先是打开浏览器时，浏览器为了更好的用户体验而做的预备工作。然后是用户手指敲入“w”后，键盘硬件触发驱动中断，让操作系统知晓“w”被敲下了，并且告知屏幕要显示“w”字体。而这期间，浏览器又会做一些额外的事情。

在这之后，当输入完整的网址后，按下回车，这里可以从四个层次来讲里面发生的事情。至于电子电路这类硬件底层的层面，因为本人接触的太浅，就暂时避而不谈。感兴趣的可以深入挖掘一下。

一个是网络通信的角度。一个是操作系统的角度。一个是服务器的角度。还有一个就是浏览器的角度。

网络通信的角度，就从DNS解析讲起。
操作系统的角度，主要就从socket通信，协议栈以及DNS缓存等方面谈起。
浏览器的角度，就涉及浏览器内核，以及网络请求。

## 从输入谈起

电路通信过程 -> 中断发生 -> 进程调度 -> 打印字符

### 输入

#### 键盘输入

键盘上的输入，即按下键帽和松开键帽这2个行为。

键盘上某个按键单独的电流回路被直接或者通过电容器间接地闭合，少量的电流此时进入了键盘的逻辑电路系统。这个系统会扫描每个键的状态，对于按键开关的电位弹跳变化进行噪音消除，并将其转化为键盘码值。这个键盘码值，似乎就是ASCII码。控制器在收到码值后，重新编码，以便把码值传输到CPU。目前传输过程大都通过通用串行总线（USB）或者蓝牙（Bluetooth）来进行。

USB键盘：

- 键码值存储在键盘内部电路一个叫做"endpoint"的寄存器内
- USB控制器大概每隔10ms便查询一次"endpoint"以得到存储的键码值数据，这个最短时间间隔由键盘提供

#### 触摸屏输入



### 中断



### 进程调度

### 屏幕打印

## 网络通信

### DNS解析

### ARP查询

### 封装

### 路由转发

### TCP三次握手

### HTTP协议

### TLS加密

### 证书验证

### IPv6

## 操作系统内核

### Socket

### 协议栈

### 网络队列

## 服务器

### 

## 浏览器

### 浏览器内核

